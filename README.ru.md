# Telegram бот-ассистент для проведения игровых мероприятий
[![workflow](https://github.com/VMSTR8/telegram_tortoise_bot/actions/workflows/docker-image.yml/badge.svg)](https://github.com/VMSTR8/telegram_tortoise_bot/tree/main)

Бот создан для организации игровых мероприятий. Работает с геолокацией пользователей и предлагает различные игровые
сценарии в зависимости от местонахождения игрока.

На данный момент ведется активная разработка бота.

Стэк: [Python 3.8](https://www.python.org/), 
[Python Telegram Bot](https://github.com/python-telegram-bot/python-telegram-bot), 
[Tortoise ORM](https://tortoise-orm.readthedocs.io/en/latest/)

## Скачивание и установка бота
Если все, что вам нужно, это запустить уже готового к работе бота, то сразу переходите к пункту 
[Установка и запуск бота через Docker](#установка-и-запуск-бота-через-Docker).

Если же вам не нужно запускать бота через докер контейнер и вы хотите поднять его через терминал, протестировать
функционал, покопаться "под капотом", то эта инструкция для вас.

Для начала клонируем себе этот репозиторий:
```bash
$ git clone https://github.com/VMSTR8/telegram_tortoise_bot.git
```
Далее, перед тем, как установить все зависимости, не забываем создать и активировать виртуальное окружение.

Создание виртуального окружения:
```bash
$ python3 -m venv venv
```

Активация для Linux и macOS:
```bash
$ source venv/bin/activate
```

Активация для Windows:
```bash
$ venv\Scripts\activate.bat
```

Ну и вот теперь уже устанавливаем зависимости:
```bash
$ pip install -r requirements.txt
```

Затем вам требуется создать и заполнить в папке **settings** файл с названием .env (да, прям так и назвать, 
с точкой в начале):
```text
BOT_TOKEN=<Токен вашего телеграм бота>
DATABASE_URL=sqlite://db.sqlite3
CREATORS_ID=<ID вашего аккаунта в телеграме>
CREATORS_USERNAME=<Ваш username в телеграме>
```
* Создать своего бота и получить токен вы можете у [@BotFather](https://t.me/BotFather).
* DATABASE_URL - ссылка на базу данных стандартная, проект использует sqlite в качестве БД. Но вдруг вам необходимо 
поменять название или иные настройки. Именно поэтому ссылка на БД вынесена в переменные окружения. Если в персональных
настройках нет смысла, скопируйте ссылку из примера.
* CREATORS_ID, это id вашего телеграм аккаунта. Выяснить его можно через ботов в телеграме. Например, через
[@userinfobot](https://t.me/userinfobot).
* CREATORS_USERNAME ваш ник в телеграме, например @fakeusernameofuser.

Как только все шаги из этого пункта сделаны, переходим к 
[инициализации базы и миграции](#инициализация-базы-и-миграции).

### Инициализация базы и миграции
Миграции запускаются довольно легко, всего лишь две команды.

Для начала передадим написанные модели инструменту миграции под названием Aerich:
```bash
$ aerich init -t database.config.TORTOISE_ORM
```

Все, что осталось сделать, это инициировать базу данных:
```bash
$ aerich init-db
```

Можете переходить к [запуску бота](#запуск-бота).

### Запуск бота
Все, что вам нужно, это ввести команду в терминале, находясь в корневой папке с проектом:
```bash
$ python main.py
```

Все! Вы великолепны :)

## Установка и запуск бота через Docker


## Roadmap
- ✅: Регистрация пользовательского позывного
- ✅: Присоединение к игровой стороне
- ✅: Админ меню
- ✅: (Для админа) Добавление, редактирование и удаление стороны
- ✅: (Для админа) Добавление, редактирование и удаление точки
- ❌: (Для админа) Вывод всех пользователей
- ❌: (Для админа) Редактирование информации пользователя
- ❌: (Для админа) Пагинация меню, когда админ просматривает стороны, точки или пользователей
- ✅: Активация игровой точки
- ❌: Возможность посмотреть, сколько осталось до вывода точки из игры
- ❌: Проверка состояния точки (Активирована (и кем) | Не активирована)
- ❌: Возможность вывода пользователем информации о себе

По мере работы над ботом в roadmap будет добавляться новый функционал, как уже реализованный, так и запланированный.